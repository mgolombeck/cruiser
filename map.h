const static uint16_t wall_normal_templates[] PROGMEM = {
    0, 65535, 46340, 46340,  8128, 65028, 29308, 58616, 20723, 62171, 36352, 54528
};

const static uint8_t vertices[] PROGMEM = {0x1, 0x3, 0x43, 0x42, 0x41, 0x30, 0x20, 0x10, 0x4, 0x14, 0x10, 0x0, 0x2, 0x13, 0x23, 0xa2, 0xa0, 0x10, 0x1, 0x0, 0x2, 0x12, 0x20, 0x10, 0x2, 0x23, 0x31, 0x10, 0x2, 0x13, 0x32, 0x1, 0x13, 0x32, 0x20, 0x1, 0x2, 0x22, 0x20, 0x30, 0x11, 0x2, 0x3, 0x14, 0x34, 0x74, 0x84, 0x83, 0x81, 0x50, 0x0, 0x1, 0x11, 0x71, 0x81, 0x80, 0x0, 0x4, 0x44, 0x40, 0x1, 0x21, 0x20, 0x0, 0x2, 0x31, 0x20, 0x1, 0x12, 0x21, 0x10, 0x1, 0x13, 0x20, 0x10, 0x2, 0x11, 0x10, 0x0, 0x1, 0x43, 0x73, 0x70, 0x0, 0x3, 0x33, 0x20, 0x2, 0x3, 0x33, 0x53, 0x83, 0x82, 0x60, 0x10, 0x1, 0x24, 0x64, 0x81, 0x70, 0x0, 0x6, 0x26, 0x23, 0x3, 0x6, 0x17, 0x27, 0x26, 0x20, 0x1, 0x11, 0x10, 0x0, 0x0, 0x3, 0x4, 0x64, 0x60};

const static uint8_t wall_normals[] PROGMEM = {0, 0, 1, 0, 1, 2, 0, 16, 0, 0, 3, 3, 51, 3, 19, 3, 16, 16, 0, 0, 64, 0, 0, 0, 0, 4, 19, 1, 17, 4, 3, 1, 0, 0, 1, 1, 80, 81};

const static uint16_t portals[] PROGMEM = {0x2009, 0x6001, 0x0, 0x2002, 0x1001, 0x3003, 0x2, 0x2004, 0x3, 0x2005, 0x4, 0x2006, 0x1007, 0x3005, 0x1008, 0x3006, 0x2009, 0x500a, 0x700b, 0xa007, 0x0, 0x2012, 0x4008, 0x1011, 0x3008, 0x100c, 0x3008, 0x100d, 0x300b, 0x100e, 0x300c, 0x100f, 0x300d, 0x1010, 0x300e, 0x500f, 0x1015, 0x5016, 0x700a, 0x1013, 0x3014, 0x5009, 0x3012, 0x3015, 0x5012, 0x1011, 0x3014, 0x1017, 0x3011, 0x1016};

const static uint8_t doors[] PROGMEM = {0x60, 0x0, 0x51, 0x31};

const static segment segments[] PROGMEM = {
//   FH  CH    X    Y  VC PC DC     V     N    P   D
    {16, 20,   0,   7,  8, 2, 1,    0,    0,   0,  0},
    {16, 20,   1,   3,  4, 2, 1,    8,    0,   2,  1},
    {16, 20,   0,   0,  7, 2, 0,   12,    4,   4,  0},
    {16, 20,  10,   0,  4, 2, 0,   19,    9,   6,  0},
    {16, 20,  11,   0,  4, 2, 0,   23,   11,   8,  0},
    {16, 20,  13,   1,  4, 2, 0,   27,   13,  10,  0},
    {16, 20,  14,   3,  4, 2, 0,   31,   11,  12,  0},
    {16, 20,  15,   5,  4, 2, 0,   35,    0,  14,  0},
    {16, 20,  12,   7, 11, 4, 0,   39,   15,  16,  0},
    {16, 20,   4,   9,  6, 3, 0,   50,   21,  20,  0},
    {16, 20,  15,  11,  4, 2, 0,   56,    0,  23,  0},
    {16, 20,  20,  10,  4, 2, 0,   60,    0,  25,  0},
    {16, 20,  22,   9,  4, 2, 0,   64,   25,  27,  0},
    {16, 20,  24,   8,  4, 2, 0,   68,   27,  29,  0},
    {16, 20,  25,   6,  4, 2, 0,   72,   29,  31,  0},
    {16, 20,  26,   5,  4, 2, 0,   76,    0,  33,  0},
    {16, 20,  23,   2,  6, 1, 0,   80,   21,  35,  0},
    {16, 20,  13,  15,  8, 3, 1,   86,   31,  36,  2},
    {16, 20,   4,  10,  6, 3, 0,   94,   35,  39,  0},
    {16, 20,   4,  11,  4, 1, 0,  100,    0,  42,  0},
    {16, 20,  10,  11,  6, 2, 0,  104,    6,  43,  0},
    {16, 20,  12,  17,  4, 2, 0,  110,    0,  45,  0},
    {16, 20,  21,  17,  4, 2, 1,  110,    0,  47,  3},
    { 8, 20,  22,  14,  5, 1, 0,  114,   21,  49,  0}
};

#define SEGMENTS_TOUCHED_SIZE 3
uint8_t segments_touched[SEGMENTS_TOUCHED_SIZE];
uint8_t segments_seen[SEGMENTS_TOUCHED_SIZE];

#define DOOR_COUNT 2
int32_t door_state[DOOR_COUNT];
